---
title: MySQL之带条件的查询
tags:
- MySQL
- 个人博客
categories:
- MySQL
mathjax: true
---

通常并不是对所有的记录都感兴趣，只是想查询**到符合某些条件**的那些记录。这些条件也被称为`搜索条件`或者`过滤条件`，当某条记录符合`搜索条件`时，它将被放入结果集中。



# 简单搜索条件

我们需要把`搜索条件`放在`WHERE`子句中，比如我们想查询`student_info`表中名字是`范剑`的学生的一些信息，可以这么写：

```mysql
mysql> SELECT number, name, id_number, major FROM student_info WHERE name = '范剑';
+----------+------+--------------------+------------+
| number   | name | id_number          | major      |
+----------+------+--------------------+------------+
| 20180105 | 范剑 | 181048199308156368 | 飞行器设计 |
+----------+------+--------------------+------------+
1 row in set
```

这个例子中的`搜索条件`就是`name = '范剑'`，也就是当记录中的`name`列的值是`'范剑'`的时候，该条记录的`number`、`name`、`id_number`、`major`这些字段才可以被放入结果集。搜索条件`name = '范剑'`中的`=`称之为`比较操作符`，除了`=`之外，设计`MySQL`的大叔还提供了很多别的比较操作符，比如：

|   操作符    |              示例               |       描述        |
| :---------: | :-----------------------------: | :---------------: |
|      =      |              a = b              |      a等于b       |
|  <> 或 !=   |             a <> b              |     a不等于b      |
|      <      |              a < b              |      a小于b       |
|      >      |              a > b              |      a 大于b      |
|     <=      |             a <= b              |    a小于等于b     |
|     \>=     |             a >= b              |    a大于等于b     |
|   BETWEEN   | a BETWEEN b AND c（必须b小于c） |  满足b <= a <= c  |
| NOT BETWEEN |      a NOT BETWEEN b AND c      | 不满足b <= a <= c |



# 匹配多个元素

有时候搜索条件中指定的匹配值并不是单个值，而是一个列表，只要匹配到列表中的某一项就算匹配成功，这种情况可以使用`IN`操作符：

| 操作符 |         示例         |            描述            |
| :----: | :------------------: | :------------------------: |
|   IN   |   a IN (b1,b2,...)   |   a是b1,b2,...中的某一个   |
| NOT IN | a NOT IN (b1,b2,...) | a不是b1,b2,...中的任意一个 |

比如我们想查询`软件工程`和`飞行器设计`专业的学生信息，可以这么写：

```mysql
mysql> SELECT number, name, id_number, major FROM student_info WHERE major IN ('软件工程', '飞行器设计');
+----------+-----------+--------------------+-----------------+
| number   | name      | id_number          | major           |
+----------+-----------+--------------------+-----------------+
| 20180103 | 范统      | 17156319980116959X | 软件工程        |
| 20180104 | 史珍香    | 141992199701078600 | 软件工程        |
| 20180105 | 范剑      | 181048199308156368 | 飞行器设计      |
+----------+-----------+--------------------+-----------------+
3 rows in set (0.01 sec)
```

如果想查询不是这两个专业的学生的信息，可以这么写：

```mysql
mysql> SELECT number, name, id_number, major FROM student_info WHERE major NOT IN ('软件工程', '飞行器设计');
+----------+-----------+--------------------+--------------------------+
| number   | name      | id_number          | major                    |
+----------+-----------+--------------------+--------------------------+
| 20180101 | 杜子腾    | 158177199901044792 | 计算机科学与工程         |
| 20180102 | 杜琦燕    | 151008199801178529 | 计算机科学与工程         |
| 20180106 | 朱逸群    | 197995199501078445 | 电子信息                 |
+----------+-----------+--------------------+--------------------------+
3 rows in set (0.00 sec)
```



有个小问题，**如果表中存在NULL值，该如何匹配搜索呢**？

`NULL`代表没有值，意味着你并不知道该列应该填入什么数据，在判断某一列是否为`NULL`的时候并**不能单纯的使用`=`操作符**，而是需要专业判断值是否是`NULL`的操作符：

|   操作符    |     示例      |     描述      |
| :---------: | :-----------: | :-----------: |
|   IS NULL   |   a IS NULL   |  a的值是NULL  |
| IS NOT NULL | a IS NOT NULL | a的值不是NULL |

比如我们想看一下`student_info`表的`name`列是`NULL`的学生记录有哪些，可以这么写：

```mysql
mysql> SELECT number, name, id_number, major FROM student_info WHERE name IS NULL;
Empty set (0.00 sec)
```

由于所有记录的`name`列都不是`NULL`值，所以最后的结果集是空的

再次强调一遍，**不能直接使用普通的操作符来与`NULL`值进行比较，必须使用`IS NULL`或者`IS NOT NULL`！**



# 多个搜索条件的查询

上边介绍的都是指定单个的搜索条件的查询，我们也可以在一个查询语句中指定多个搜索条件。



## AND操作符

在给定多个搜索条件的时候，我们有时需要某条记录只在**符合所有搜索条件**的时候才将其加入结果集，这种情况我们可以使用`AND`操作符来连接多个搜索条件。

```mysql
mysql> SELECT * FROM student_score WHERE subject = '母猪的产后护理' AND score > 75;
+----------+-----------------------+-------+
| number   | subject               | score |
+----------+-----------------------+-------+
| 20180101 | 母猪的产后护理        |    78 |
| 20180102 | 母猪的产后护理        |   100 |
+----------+-----------------------+-------+
2 rows in set (0.00 sec)
```

其中的`subject = '母猪的产后护理'`和`score > 75`是两个搜索条件，我们使用`AND`操作符把这两个搜索条件连接起来表示只有当两个条件都满足的记录才能被加入到结果集。



## **OR操作符**

在给定多个搜索条件的时候，我们有时需要某条记录在**符合某一个搜索条件的时候**就将其加入结果集中，这种情况我们可以使用`OR`操作符来连接多个搜索条件。

比如我们想从`student_score`表中找出成绩大于`95`分或者小于`55`分的记录，可以这么写：

```mysql
mysql> SELECT * FROM student_score WHERE score > 95 OR score < 55;
+----------+-----------------------------+-------+
| number   | subject                     | score |
+----------+-----------------------------+-------+
| 20180102 | 母猪的产后护理              |   100 |
| 20180102 | 论萨达姆的战争准备          |    98 |
| 20180104 | 论萨达姆的战争准备          |    46 |
+----------+-----------------------------+-------+
3 rows in set (0.00 sec)
```



注意：**AND操作符的优先级高于OR操作符，也就是说在判断某条记录是否符合条件时会先检测AND操作符两边的搜索条件**

例如：

```mysql
score > 95 OR score < 55 AND subject = '论萨达姆的战争准备'
```

上述语句可以被看作下面两个条件中任意一个条件成立则使整个式子成立：

- score > 95
- score < 55 AND subject = '论萨达姆的战争准备'



这种优先级是非常尴尬的！因此为了避免这种尴尬，可以用小括号()显示指定各搜索条件优先级，比如上面式子可以写成这样：

```mysql
(score > 95 OR score < 55) AND subject = '论萨达姆的战争准备';
```

